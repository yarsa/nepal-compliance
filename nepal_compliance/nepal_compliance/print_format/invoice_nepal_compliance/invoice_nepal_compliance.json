{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-06-24 09:44:25.602245",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Sales Invoice",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "<style>\n    .invoice-copy {\n        page-break-after: always;\n        margin-bottom: 50px;\n    }\n\n    .invoice-section {\n        border: 1px solid #000;\n        padding: 20px;\n    }\n\n    .company-header {\n        display: flex;\n        align-items: center;\n        gap: 20px;\n        margin-bottom: 15px;\n    }\n\n    .company-logo img {\n        height: 60px;\n        width: auto;\n    }\n\n    .company-details {\n        font-size: 14px;\n        line-height: 1.6;\n    }\n\n    .company-details .company-name {\n        font-size: 18px;\n        font-weight: bold;\n        text-transform: uppercase;\n    }\n    .copy-label {\n        margin-top: 5px;\n        font-weight: bold;\n        font-size: 14px;\n        /*color: red;*/\n        text-transform: uppercase;\n    }\n    .title {\n        text-align: center;\n        font-size: 16px;\n        font-weight: bold;\n        margin-bottom: 15px;\n        text-transform: uppercase;\n        border-top: 1px dashed #000;\n        padding-top: 5px;\n    }\n    .invoice-header {\n        display: flex;\n        justify-content: space-between;\n        font-size: 12px;\n    }\n\n    .invoice-header div {\n        display: flex;\n        flex-direction: column;\n    }\n    \n    table {\n        width: 100%;\n        border-collapse: collapse;\n        margin-top: 10px;\n        border: 1px solid #000;\n    }\n\n    th, td {\n        border: 1px solid #ddd;\n        padding: 8px;\n        font-size: 12px;\n    }\n\n    .user-printed {\n        /*margin-top: 10px;*/\n        font-size: 12px;\n        text-align: right;\n        font-weight: normal;\n        color: #555;\n    }\n</style>\n\n{% set is_return = doc.is_return or doc.return_against %}\n\n{% set actual_print_count = frappe.get_list(\"Access Log\", filters={\n    \"reference_document\": doc.name, \n    \"file_type\": \"PDF\",\n    \"method\": \"Print\"\n}) | length %}\n\n{% set copy_no = actual_print_count %}\n\n{% if is_return %}\n    {% set titles = [\"Credit NOTE\"] %}\n{% elif actual_print_count == 0 %}\n    {% set titles = [\"TAX INVOICE\", \"INVOICE\"] %}\n{% else %}\n    {% set titles = [\"INVOICE\"] %}\n{% endif %}\n\n{% set company = frappe.get_doc(\"Company\", doc.company) %}\n\n{% for title in titles %}\n<div class=\"invoice-copy\">\n    <div class=\"invoice-section\">\n        {% set address_list = frappe.get_all(\"Address\", filters={\"link_name\": doc.company}, limit=1) %}\n        {% if address_list %}\n            {% set address_doc = frappe.get_doc(\"Address\", address_list[0].name) %}\n        {% endif %}\n\n        <div class=\"company-header\">\n            <div class=\"company-logo\">\n                {% if company.logo_for_printing %}\n                    <img src=\"{{ company.logo_for_printing }}\" alt=\"Company Logo\">\n                {% else %}\n                    <div style=\"font-size: 12px; color: gray;\">[No Logo]</div>\n                {% endif %}\n            </div>\n            <div class=\"company-details\" style=\"font-family: Courier, monospace; font-size: 12px; line-height: 1.5; display: flex; flex-direction: column; align-items: center;\">\n                <div class=\"company-name\">{{ company.name }}</div>\n                <div>\n                    {% if address_doc %}\n                        {{ address_doc.city }}, {{ address_doc.country }}\n                    {% else %}\n                        {{ company.city }}, {{ company.country }}\n                    {% endif %}\n                </div>\n                <div>\n                    {% if address_doc and address_doc.phone %}{{ address_doc.phone }}{% else %}N/A{% endif %}\n                </div>\n                <div>VAT: {{ company.tax_id or \"\" }}</div>\n                {% if not is_return and copy_no > 0 %}\n                    <div class=\"copy-label\">Copy of Original {{ copy_no }}</div>\n                {% endif %}\n            </div>\n        </div>\n\n        <div class=\"title\">{{ title }}</div>\n\n        <!-- Added Flexbox for Date and Miti alignment -->\n        <div class=\"invoice-header\">\n            <div>\n                <p><strong>Invoice No:</strong> {{ doc.name }}</p>\n                <p><strong>Customer:</strong> {{ doc.customer_name }}</p>\n                <p><strong>Tax ID:</strong> {{ doc.tax_id or \"\" }}</p>\n            </div>\n            <div>\n                <p><strong>Date:</strong> {{ frappe.utils.formatdate(doc.posting_date) }}</p>\n                <p><strong>Miti:</strong> {{ doc.nepali_date }}</p>\n                <p><strong>Printed By:</strong> {{ frappe.session.user }}</p>\n            </div>\n        </div>\n\n        <!-- Added \"Printed By\" just after Miti -->\n        <!--<div class=\"user-printed\">-->\n        <!--    <p><strong>Printed By:</strong> {{ frappe.session.user }}</p>-->\n        <!--</div>-->\n\n        <p><strong>Address:</strong> {{ address_doc.address_line1 }}</p>\n\n        <table>\n            <thead>\n                <tr>\n                    <th>S.N</th>\n                    <th>H.S. Code</th>\n                    <th>Item</th>\n                    <th>Description</th>\n                    <th>Qty</th>\n                    <th>Rate</th>\n                    <th>Amount</th>\n                </tr>\n            </thead>\n            <tbody>\n                {% for item in doc.items %}\n                <tr>\n                    <td>{{ loop.index }}</td>\n                    <td>{{ item.hs_code or \"\" }}</td>\n                    <td>{{ item.item_code }}</td>\n                    <td>{{ item.description }}</td>\n                    <td>{{ item.qty }}</td>\n                    <td>{{ item.rate }}</td>\n                    <td>{{ item.amount }}</td>\n                </tr>\n                {% endfor %}\n            </tbody>\n        </table>\n        \n        <p>----------------------------------------</p>\n        <p><strong>Subtotal:</strong> {{ doc.currency }} {{ \"{:,.2f}\".format(doc.total or item.discount_amount) }}</p>\n        <p>----------------------------------------</p>\n        <!--<p><strong>Subtotal:</strong> {{ doc.currency }} {{ \"{:,.2f}\".format(doc.total or item.discount_amount) }}</p>-->\n        <!--<br>-->\n        {% set ns = namespace(taxable_amount=0, nontaxable_amount=0, total_amount=0) %}\n        {% if doc.discount_amount %}\n            {% set discount_amount = doc.discount_amount %}\n        {% else %}\n            {% set ns_discount = namespace(total=0) %}\n            {% for item in doc.items %}\n                {% set ns_discount.total = ns_discount.total + (item.discount_amount or 0) %}\n            {% endfor %}\n            {% set discount_amount = ns_discount.total %}\n        {% endif %}\n\n        {% for item in doc.items %}\n            {% if item.is_nontaxable_item %}\n                {% set ns.nontaxable_amount = ns.nontaxable_amount + item.net_amount if item.net_amount else ns.nontaxable_amount + item.amount %}\n            {% else %}\n                {% set ns.taxable_amount = ns.taxable_amount + item.net_amount if item.net_amount else ns.taxable_amount + item.amount %}\n            {% endif %}\n        {% endfor %}\n\n        {% if ns.total_amount > 0 %}\n            {% set taxable_discount = (ns.taxable_amount / ns.total_amount) * discount_amount %}\n        {% else %}\n            {% set taxable_discount = 0 %}\n        {% endif %}\n\n        {% set vat_amount = ns.taxable_amount * 0.13 if ns.taxable_amount and doc.total_taxes_and_charges else doc.total_taxes_and_charges %}\n        {% set grand_total = (ns.taxable_amount + ns.nontaxable_amount + vat_amount) %}\n\n        <div>\n            <!--<p>----------------------------------------</p>-->\n            <p><strong>Discount:</strong> {{ doc.currency }} {{ \"{:,.2f}\".format(discount_amount) }}</p>\n            <p><strong>Non-Taxable Amount:</strong> {{ doc.currency }} {{ \"{:,.2f}\".format(ns.nontaxable_amount) }}</p>\n            <p><strong>Taxable Amount:</strong> {{ doc.currency }} {{ \"{:,.2f}\".format(ns.taxable_amount) }}</p>\n            <p><strong>13% VAT:</strong> {{ doc.currency }} {{ \"{:,.2f}\".format(vat_amount) }}</p>\n            <p><strong>Grand Total:</strong> {{ doc.currency }} {{ \"{:,.2f}\".format(doc.rounded_total) }}</p>\n            <p>----------------------------------------</p>\n        </div>\n        <!--<br>-->\n        <p><strong>In Words:</strong> {{ doc.in_words }}</p>\n    </div>\n</div>\n{% endfor %}",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-07-03 10:44:39.129372",
 "modified_by": "Administrator",
 "module": "Nepal Compliance",
 "name": "Invoice Nepal Compliance",
 "owner": "Administrator",
 "page_number": "Hide",
 "pdf_generator": "wkhtmltopdf",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}